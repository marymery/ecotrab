	<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>Chart: Map&Chart</title>
		<style type="text/css">
			@import "../../../../dojo/resources/dojo.css";
			@import "../../../../dijit/tests/css/dijitTests.css";
			@import "../../../../dijit/themes/tundra/tundra.css";
			@import "../resources/Map.css";
			.mapContainer {
				display: none;
				width: 810px;
				height: 400px;
				border: solid 1px;
			}
			
			.mapVerticalContainer {
				display: none;
				width: 405px;
				height: 500px;
				border: solid 1px;
			}

		@import "{{baseUrl}}dojox/layout/resources/FloatingPane.css";
		@import "{{baseUrl}}dojox/layout/resources/ResizeHandle.css";


		</style>
		<script type="text/javascript" djConfig="parseOnLoad:true,isDebug:true,gfxRenderer:'svg,canvas,vml,silverlight'" src="../../../../dojo/dojo.js"></script>
		<script type="text/javascript">
				var isTouchDevice = dojo.isIos || (navigator.userAgent.toLowerCase().indexOf("android") > -1)
				|| (navigator.userAgent.toLowerCase().indexOf("blackberry") > -1);
		</script>
		<script type="text/javascript">
			dojo.require("dojox.geo.charting.Map");
			dojo.require("dojox.charting.Chart");
			dojo.require("dojox.charting.axis2d.Default");
      		dojo.require("dojox.charting.plot2d.ClusteredBars");
			dojo.require("dojox.charting.plot2d.Grid");
			dojo.require("dojo.data.ItemFileReadStore");
			dojo.requireIf(isTouchDevice,"dojox.geo.charting.TouchInteractionSupport");
			dojo.requireIf(!isTouchDevice,"dojox.geo.charting.MouseInteractionSupport");
			dojo.require("dojox.geo.charting.KeyboardInteractionSupport");
			dojo.require("dojox.charting.themes.PlotKit.blue");

////////////////////////////////////////////////////////////////////////
			dojo.require("dojox.layout.FloatingPane");

			
		
var pFloatingPane;

dojo.ready(function(){
  pFloatingPane = new dojox.layout.FloatingPane({
     //title: "",
     resizable: false, dockable: false, resizeable: false,
     style: "position:relative;top:120;right:500;width:200px;height:320px;visibility:hidden;background:#fff",
     id: "pFloatingPane"
  }, dojo.byId("pFloatingPane"));


});
			
			var chartStore = new dojo.data.ItemFileReadStore({
				url: "datastore/datosCenso.json"
			});

			var chart,series,productList;
			var texto4 = "texto4";

			dojo.addOnLoad(function(){

							//document.write(texto);
				//document.write(texto2);

				productSeries = [0,0,0,0,0,0];
            	productList = ["product A", "product B","product C","product D","product E","product F"];
			
				
				var map = new dojox.geo.charting.Map("map", "../resources/data/Spain.json");
				//map.setMarkerData("../resources/markers/USStates.json");
				// install mouse/touch navigation
				if (!isTouchDevice) {
					var mouseInteraction = new dojox.geo.charting.MouseInteractionSupport(map,{enablePan:true,enableZoom:true});
					mouseInteraction.connect();
				
				} else {
					var touchInteraction = new dojox.geo.charting.TouchInteractionSupport(map,{});
					touchInteraction.connect();
					// Aqui no entra

				}

				var keyboardInteraction = new dojox.geo.charting.KeyboardInteractionSupport(map, {enableZoom: true});
				keyboardInteraction.connect();

///////////////////////////////////////////////////////////////////////////////////////////




///////////////////////////////////////////////////////////////////////////////////////////////////////



				map.onFeatureOver = function(feature){
					
						 	chartStore.fetchItemByIdentity({
				                        identity: feature.id,
				                        onItem: function(item){

								// Anyadimos el titulo al panel
								pFloatingPane.setTitle("<b>"+feature.id+"</b>");
								// Anyadimos los datos al contenido del panel								
								pFloatingPane.setContent("Edades_0-4: "+chartStore.getValue(item, "Edades_0-4")+"<br>"
									+"Edades_5-9: "+chartStore.getValue(item, "Edades_5-9")+"<br>"
									+"Edades_10-14: "+chartStore.getValue(item, "Edades_10-14")+"<br>"
									+"Edades_15-19: "+chartStore.getValue(item, "Edades_15-19")+"<br>"
									+"Edades_20-24: "+chartStore.getValue(item, "Edades_20-24")+"<br>"
									+"Edades_25-29: "+chartStore.getValue(item, "Edades_25-29")+"<br>"
									+"Edades_30-34: "+chartStore.getValue(item, "Edades_30-34")+"<br>"
									+"Edades_35-39: "+chartStore.getValue(item, "Edades_35-39")+"<br>"
									+"Edades_40-44: "+chartStore.getValue(item, "Edades_40-44")+"<br>"
									+"Edades_45-49: "+chartStore.getValue(item, "Edades_45-49")+"<br>"
									+"Edades_50-54: "+chartStore.getValue(item, "Edades_50-54")+"<br>"
									+"Edades_55-59: "+chartStore.getValue(item, "Edades_55-59")+"<br>"
									+"Edades_60-64: "+chartStore.getValue(item, "Edades_60-64")+"<br>"
									+"Edades_65-69: "+chartStore.getValue(item, "Edades_65-69")+"<br>"
									+"Edades_70-74: "+chartStore.getValue(item, "Edades_70-74")+"<br>"
									+"Edades_75-79: "+chartStore.getValue(item, "Edades_75-79")+"<br>"
									+"Edades_80-84: "+chartStore.getValue(item, "Edades_80-84")+"<br>"
									+"Edades_85-89: "+chartStore.getValue(item, "Edades_85-89")+"<br>"
									+"Edades_90+: "+chartStore.getValue(item, "Edades_90+")+"<br>");										
								pFloatingPane.startup();
								
			                                        

							}
						});
					pFloatingPane.show();	
							  
							//alert(chartStore.getValue("VT","product B"));
							//alert("aa"+dojo.global["datos"]);
												//alert(dojo.global["informacion"]);

						
						//pFloatingPanes[0].title = "Nuevo titulo";
						
					texto = dojo.global["datos"];


					
					
					// Si no tenemos el cursor encima de alguna provincia, no mostramos ningun panel
					
					
						
						
					
/////////////////////////////		
							
					if (!feature) {
						
						
						productSeries = [0,0,0,0,0,0];
						chart.updateSeries("productSeries",productSeries);
						chart.render();


					} else if (!feature.isSelected) {
						

						chartStore.fetchItemByIdentity({
			            	identity: feature.id,
			            	onItem: function(item){


				                for (var i = productList.length - 1; i >= 0; i--){
																	

							
								//document.write("entra else");


									productSeries[i] = chartStore.getValue(item, productList[i]);
								//document.write("pepito");
								//document.write(productSeries[i]);
								};
								chart.updateSeries("productSeries",productSeries);
								chart.render();
			            	}
			        	});
					}
				};
			});
		</script>
	</head>
	<body class="tundra">
		<h1>Mapa provincial de Espa√±a</h1>
		<p>Situa el cursor sobre la provincia para obtener sus datos</p>
		<div style="width:610px;height:400px;border:solid 1px;background:#f5f5f5;" id="map">
			<div id="pFloatingPane"></div>		

		 </div>

			

			
			

		

		</div>
	</body>
</html>
